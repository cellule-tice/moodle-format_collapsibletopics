define ("format_collapsibletopics/collapsibletopics",["jquery","core/log","core/str"],function(a,b,c){"use strict";var d=function(a,b,c){if("local"==c){window.localStorage.setItem("sections-toggle-"+a,JSON.stringify(b))}else if("session"==c){window.sessionStorage.setItem("sections-toggle-"+a,JSON.stringify(b))}},e=function(a,b){var c;if("local"==b){c=window.localStorage.getItem("sections-toggle-"+a)}else if("session"==b){c=window.sessionStorage.getItem("sections-toggle-"+a)}if(null===c){return{}}else{return JSON.parse(c)}};return{init:function init(f){b.debug("Format collapsibletopics AMD module initialized");a(document).ready(function(a){var b,g=f.keepstateoversession,h;if(1==g){h="local"}else{h="session"}b=e(f.course,h);setTimeout(function(){for(var c in b){c="#collapse-"+parseInt(c);a(c).collapse("show")}var d=a(".section.current a.sectiontoggle").attr("href");a(d).collapse("show")},50);a("body").on("click",".expandall",function(c){c.preventDefault();var e=c.target;a(e).removeClass("expandall").addClass("collapseall").html(M.util.get_string("collapseall","moodle"));a(".sectiontoggle").each(function(c){a("#collapse-"+(c+1)).collapse("show");if(!b.hasOwnProperty(c+1)){b[c+1]="true";d(f.course,b,h)}})});a("body").on("click",".collapseall",function(c){c.preventDefault();var e=c.target;a(e).removeClass("collapseall").addClass("expandall").html(M.util.get_string("expandall","moodle"));a(".sectiontoggle").each(function(c){a("#collapse-"+(c+1)).collapse("hide");if(b.hasOwnProperty(c+1)){delete b[c+1];d(f.course,b,h)}})});a("#nav-drawer div.media").on("click",function(b){var c=a(b.target).parent().parent().parent().attr("href");if(-1!=c.lastIndexOf("#section-")){var d=c.substring(c.lastIndexOf("-")+1);a("#collapse-"+d).collapse("show")}});a(".collapse").on("show.bs.collapse",function(c){var e=a(c.target).attr("id"),g=e.substring(e.lastIndexOf("-")+1);if(!b.hasOwnProperty(g)){b[g]="true";d(f.course,b,h)}});a(".collapse").on("hide.bs.collapse",function(c){var e=a(c.target).attr("id"),g=e.substring(e.lastIndexOf("-")+1);if(b.hasOwnProperty(g)){delete b[g];d(f.course,b,h)}});a("body").on("click",".togglecompletion button",function(b){var d=b.target,e=a(d).parent().parent().children("input[name=\"completionstate\"]").val(),f=a(d).closest("li.section"),g=a(f).find(".progress-bar"),h=parseInt(a(g).attr("aria-valuenow")),i=1==e?h+1:h-1,j=parseInt(a(g).attr("aria-valuemax")),k=Math.round(100*(i/j));a(g).attr("aria-valuenow",i);a(g).attr("style","width: "+k+"%");c.get_strings([{key:"progresstotal",component:"completion",param:{complete:i,total:j}}]).then(function(b){a(g).attr("data-original-title",b)})})})}}});
//# sourceMappingURL=collapsibletopics.min.js.map
